{"version":3,"sources":["maths.ts","Arrow.tsx","BarycentricDemo.tsx","hooks.ts","tools.ts","SimpleEditor.tsx","TrianglesDemo.tsx","Home.tsx","App.tsx","index.tsx"],"names":["Vec2","x","y","rhs","this","f","len","currentLen","scale","theta","cos","Math","sin","Mat2","timesVec","sqrt","a","b","c","d","det","Vec3","z","Arrow","props","x1","y1","x2","y2","stroke","strokeWidth","className","wing1","rotate","PI","scaleTo","wing2","corner1","minus","corner2","classNames","fill","DragSubject","initState","origin","tri1","tri2","tri3","pt","drag","startDrag","type","payload","reducer","state","action","key","Origin","Pt","Tri1","Tri2","Tri3","dragSubjectToKey","BarycentricDemo","ref","onChange","onUp","React","useRef","useState","left","top","bounds","setBounds","useEffect","recomputeBounds","current","getBoundingClientRect","window","addEventListener","removeEventListener","handleMove","e","clientX","clientY","document","useMousePos","dispatch","moveMouse","useReducer","map","t1","t2","t3","p","u","v","baryCoords","leftInv","uStart","uEnd","plus","vStart","vEnd","f1","toPrecision","f2","f3","style","position","xmlns","width","height","viewBox","cx","cy","r","onMouseDown","range","lo","hi","res","n","push","SimpleEditor","lineCount","setLineCount","isFocused","setIsFocused","placeholder","value","recomputeLineCount","useCallback","text","lines","split","length","focused","ln","target","onFocus","onBlur","spellCheck","WIDTH","HEIGHT","PX_SIZE","PX_PER_MARKER","SVG_OVERLAY_OFFSET","drawPx","px","img","zBuf","pxX","floor","pxY","loc","base","data","color","toVertex","line","parts","trim","hex","match","RegExp","exec","groups","g","parseInt","toColor","undefined","Number","toTri","v1","v2","v3","nonemptyLines","l","filter","SvgOverlay","xPx","TrianglesDemo","verticesText","setVerticesText","trisText","setTrisText","options","canvasRef","context","setContext","getContext","useCanvasRenderingContext2D","alpha","repaint","model","vertices","tris","t","constructModel","getImageData","i","clearContext","Uint8ClampedArray","PX_WIDTH","forEach","tri","some","vI","minX","min","minY","maxX","max","maxY","trans","relToA","fA","fB","fC","fromArray","toArray","renderTri","renderModel","putImageData","Home","to","App","path","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.b8cbdd11.chunk.js","sourcesContent":["export class Vec2 {\n  constructor(public x: number, public y: number) {}\n\n  plus(rhs: Vec2): Vec2 {\n    return new Vec2(this.x + rhs.x, this.y + rhs.y);\n  }\n\n  minus(rhs: Vec2): Vec2 {\n    return new Vec2(this.x - rhs.x, this.y - rhs.y);\n  }\n\n  scale(f: number): Vec2 {\n    return new Vec2(f * this.x, f * this.y);\n  }\n\n  scaleTo(len: number): Vec2 {\n    const currentLen = this.len();\n    if (currentLen === 0) {\n      return this;\n    }\n\n    const f = len / currentLen;\n    return this.scale(f);\n  }\n\n  rotate(theta: number): Vec2 {\n    const cos = Math.cos(theta);\n    const sin = Math.sin(theta);\n    return new Mat2(cos, sin, -sin, cos).timesVec(this);\n  }\n\n  len(): number {\n    return Math.sqrt(this.x * this.x + this.y * this.y);\n  }\n}\n\nexport class Mat2 {\n  // | a  c |\n  // | b  d |\n  // prettier-ignore\n  constructor(\n    public a: number, public b: number,\n    public c: number, public d: number,\n  ) {}\n\n  timesVec(rhs: Vec2): Vec2 {\n    const { a, b, c, d } = this;\n    const { x, y } = rhs;\n    return new Vec2(a * x + c * y, b * x + d * y);\n  }\n\n  leftInv(): Mat2 {\n    const { a, b, c, d } = this;\n    const det = a * d - b * c;\n    return new Mat2(d, -c, -b, a).scale(1 / det);\n  }\n\n  scale(f: number): Mat2 {\n    const { a, b, c, d } = this;\n    return new Mat2(f * a, f * b, f * c, f * d);\n  }\n}\n\nexport class Vec3 {\n  constructor(public x: number, public y: number, public z: number) {}\n\n  scale(f: number): Vec3 {\n    return new Vec3(f * this.x, f * this.y, f * this.z);\n  }\n\n  plus(rhs: Vec3): Vec3 {\n    return new Vec3(this.x + rhs.x, this.y + rhs.y, this.z + rhs.z);\n  }\n\n  static fromArray([x, y, z]: [number, number, number]): Vec3 {\n    return new Vec3(x, y, z);\n  }\n\n  toArray(): [number, number, number] {\n    return [this.x, this.y, this.z];\n  }\n}\n","import classNames from 'classnames';\nimport { Vec2 } from './maths';\n\ninterface ArrowProps {\n  x1: number;\n  y1: number;\n  x2: number;\n  y2: number;\n  stroke?: string;\n  strokeWidth?: number;\n  className?: string;\n}\n\nconst Arrow: React.FC<ArrowProps> = props => {\n  const { x1, y1, x2, y2, stroke, strokeWidth, className } = props;\n\n  const base = new Vec2(x2 - x1, y2 - y1);\n  const wing1 = base.rotate(Math.PI / 10).scaleTo(15);\n  const wing2 = wing1.rotate(-Math.PI / 5);\n  const corner1 = new Vec2(x2, y2).minus(wing1);\n  const corner2 = new Vec2(x2, y2).minus(wing2);\n\n  return (\n    <g className={classNames(className, 'arrow')}>\n      <line\n        x1={x1}\n        y1={y1}\n        x2={x2}\n        y2={y2}\n        stroke={stroke}\n        strokeWidth={strokeWidth}\n      />\n      <path\n        d={`M ${x2} ${y2}\n            L ${corner1.x} ${corner1.y}\n            L ${corner2.x} ${corner2.y}\n            Z`}\n        fill={stroke}\n      />\n    </g>\n  );\n};\n\nexport default Arrow;\n","import React from 'react';\nimport Arrow from './Arrow';\nimport { useMousePos } from './hooks';\nimport { Vec2, Mat2 } from './maths';\nimport { Action } from './action';\nimport './BarycentricDemo.css';\n\nconst WIDTH = 966;\nconst HEIGHT = 600;\n\nenum DragSubject {\n  Origin = 'Origin',\n  Tri1 = 'Tri1',\n  Tri2 = 'Tri2',\n  Tri3 = 'Tri3',\n  Pt = 'Pt',\n}\n\nconst BarycentricDemo: React.FC<{}> = () => {\n  const ref = useMousePos({\n    onChange: (x, y) => dispatch(moveMouse(x, y)),\n    onUp: () => dispatch(stopDrag()),\n  });\n  const [state, dispatch] = React.useReducer(reducer, initState);\n\n  const { origin, tri1, tri2, tri3, pt } = state;\n\n  function toScreenSpace(pt: Vec2): Vec2 {\n    return new Vec2(origin.x + pt.x, origin.y - pt.y);\n  }\n\n  // Transform triangle points and `pt` into our (svg) \"screen\" space\n  const [t1, t2, t3, p] = [tri1, tri2, tri3, pt].map(toScreenSpace);\n\n  const u = t2.minus(t1);\n  const v = t3.minus(t1);\n  const changeOfBasis = new Mat2(u.x, v.x, u.y, v.y).leftInv();\n  const baryCoords = changeOfBasis.timesVec(p.minus(t1));\n\n  // Additional points for indicating the position of `pt` in terms of\n  // its barycentric coordinates\n  const uStart = t1;\n  const uEnd = t1.plus(t2.minus(t1).scale(baryCoords.x));\n  const vStart = uEnd;\n  const vEnd = vStart.plus(t3.minus(t1).scale(baryCoords.y));\n\n  // Contributions from each of the triangle's corners\n  const f1 = (1 - baryCoords.x - baryCoords.y).toPrecision(2);\n  const f2 = baryCoords.x.toPrecision(2);\n  const f3 = baryCoords.y.toPrecision(2);\n\n  return (\n    <div className=\"barycentric-demo\">\n      <div style={{ position: 'relative' }}>\n        <svg\n          ref={ref}\n          xmlns=\"http://www.w3.org/2000/svg\"\n          width={WIDTH}\n          height={HEIGHT}\n          viewBox={`0 0 ${WIDTH} ${HEIGHT}`}\n        >\n          {/* Origin */}\n          <Arrow\n            x1={origin.x}\n            y1={origin.y}\n            x2={origin.x + 60}\n            y2={origin.y}\n            className=\"gray-2\"\n          />\n          <Arrow\n            x1={origin.x}\n            y1={origin.y}\n            x2={origin.x}\n            y2={origin.y - 60}\n            className=\"gray-2\"\n          />\n          <circle\n            className=\"moveable gray-2\"\n            cx={origin.x}\n            cy={origin.y}\n            r=\"6\"\n            onMouseDown={() => dispatch(startDrag(DragSubject.Origin))}\n          />\n\n          {/* Triangle */}\n          <path\n            d={`M ${t1.x} ${t1.y}\n              L ${t2.x} ${t2.y}\n              L ${t3.x} ${t3.y}\n              Z`}\n            stroke=\"#ddd\"\n            fill=\"#ddd5\"\n          />\n\n          {/* Coordinates w.r.t. triangle's \"base point\" (`tri1`) */}\n          <Arrow x1={t1.x} y1={t1.y} x2={p.x} y2={t1.y} stroke=\"#ddd\" />\n          <Arrow x1={p.x} y1={t1.y} x2={p.x} y2={p.y} stroke=\"#ddd\" />\n\n          {/* Barycentric Info */}\n          <Arrow\n            x1={uStart.x}\n            y1={uStart.y}\n            x2={uEnd.x}\n            y2={uEnd.y}\n            className=\"yellow\"\n          />\n          <Arrow\n            x1={vStart.x}\n            y1={vStart.y}\n            x2={vEnd.x}\n            y2={vEnd.y}\n            className=\"red\"\n          />\n\n          {/* Triangle handles */}\n          <circle\n            className=\"moveable green\"\n            cx={t1.x}\n            cy={t1.y}\n            r=\"6\"\n            onMouseDown={() => dispatch(startDrag(DragSubject.Tri1))}\n          />\n          <circle\n            className=\"moveable yellow\"\n            cx={t2.x}\n            cy={t2.y}\n            r=\"6\"\n            onMouseDown={() => dispatch(startDrag(DragSubject.Tri2))}\n          />\n          <circle\n            className=\"moveable red\"\n            cx={t3.x}\n            cy={t3.y}\n            r=\"6\"\n            onMouseDown={() => dispatch(startDrag(DragSubject.Tri3))}\n          />\n\n          {/* Free Point */}\n          <circle\n            className=\"moveable blue\"\n            cx={p.x}\n            cy={p.y}\n            r=\"6\"\n            onMouseDown={() => dispatch(startDrag(DragSubject.Pt))}\n          />\n        </svg>\n\n        <div style={{ position: 'absolute', left: p.x + 5, top: p.y + 3 }}>\n          <span className=\"gray-1\">(</span>\n          <span className=\"green\">{f1}</span>\n          <span className=\"gray-1\">,</span>\n          <span className=\"yellow\">{f2}</span>\n          <span className=\"gray-1\">,</span>\n          <span className=\"red\">{f3}</span>\n          <span className=\"gray-1\">)</span>\n        </div>\n      </div>\n\n      <div className=\"instructions\">\n        All points (e.g. <div className=\"dot green\"></div>,\n        <div className=\"dot yellow\"></div>) can be dragged with the cursor. The\n        ordered triple shows contributions from each of the triangle's corners\n        at the location of the blue point (<div className=\"dot blue\"></div>).\n      </div>\n    </div>\n  );\n};\n\ninterface State {\n  // Relative to svg element\n  origin: Vec2;\n\n  // Relative to origin\n  tri1: Vec2;\n  tri2: Vec2;\n  tri3: Vec2;\n  pt: Vec2;\n\n  drag: DragSubject | null;\n}\n\nconst initState: State = {\n  origin: new Vec2(140, 500),\n  tri1: new Vec2(160, 140),\n  tri2: new Vec2(280, 400),\n  tri3: new Vec2(500, 200),\n  pt: new Vec2(340, 270),\n  drag: null,\n};\n\nfunction moveMouse(x: number, y: number): Action {\n  return {\n    type: 'MOVE_MOUSE',\n    payload: new Vec2(x, y),\n  };\n}\n\nfunction stopDrag(): Action {\n  return {\n    type: 'STOP_DRAG',\n  };\n}\n\nfunction startDrag(drag: DragSubject): Action {\n  return {\n    type: 'START_DRAG',\n    payload: drag,\n  };\n}\n\nfunction fromScreenSpace(origin: Vec2, pt: Vec2): Vec2 {\n  return new Vec2(pt.x - origin.x, origin.y - pt.y);\n}\n\nfunction reducer(state: State, action: Action): State {\n  switch (action.type) {\n    case 'MOVE_MOUSE':\n      if (!state.drag) {\n        return state;\n      } else {\n        const key: string = dragSubjectToKey(state.drag);\n        if (key === 'origin') {\n          return { ...state, [key]: action.payload };\n        } else {\n          return {\n            ...state,\n            [key]: fromScreenSpace(state.origin, action.payload),\n          };\n        }\n      }\n    case 'START_DRAG':\n      return {\n        ...state,\n        drag: action.payload,\n      };\n    case 'STOP_DRAG':\n      return {\n        ...state,\n        drag: null,\n      };\n    default:\n      return state;\n  }\n}\n\nfunction dragSubjectToKey(drag: DragSubject): keyof State {\n  switch (drag) {\n    case DragSubject.Origin:\n      return 'origin';\n    case DragSubject.Pt:\n      return 'pt';\n    case DragSubject.Tri1:\n      return 'tri1';\n    case DragSubject.Tri2:\n      return 'tri2';\n    case DragSubject.Tri3:\n      return 'tri3';\n  }\n}\n\nexport default BarycentricDemo;\n","import React from 'react';\n\nexport interface UseMousePos {\n  onChange: (x: number, y: number) => any;\n  onUp: () => any;\n}\n\nexport function useMousePos({\n  onChange,\n  onUp,\n}: UseMousePos): React.RefObject<any> {\n  const ref: React.RefObject<any> = React.useRef(null);\n  const [bounds, setBounds] = React.useState({ left: 0, top: 0 });\n\n  React.useEffect(() => {\n    function recomputeBounds() {\n      if (ref.current !== null) {\n        const { left, top } = ref.current.getBoundingClientRect();\n        setBounds({ left, top });\n      }\n    }\n\n    recomputeBounds();\n\n    window.addEventListener('resize', recomputeBounds);\n    return () => window.removeEventListener('resize', recomputeBounds);\n  }, [ref, setBounds]);\n\n  React.useEffect(() => {\n    function handleMove(e: MouseEvent) {\n      const { left, top } = bounds;\n      const { clientX, clientY } = e;\n\n      onChange(clientX - left, clientY - top);\n    }\n\n    document.addEventListener('mousemove', handleMove);\n    return () => document.removeEventListener('mousemove', handleMove);\n  }, [bounds, onChange]);\n\n  React.useEffect(() => {\n    document.addEventListener('mouseup', onUp);\n    return () => document.removeEventListener('mouseup', onUp);\n  }, [onUp]);\n\n  return ref;\n}\n\nexport function useCanvasRenderingContext2D(\n  options?: CanvasRenderingContext2DSettings,\n): [CanvasRenderingContext2D | undefined, React.RefObject<HTMLCanvasElement>] {\n  const canvasRef: React.RefObject<HTMLCanvasElement> = React.useRef(null);\n  const [context, setContext] = React.useState<CanvasRenderingContext2D>();\n\n  React.useEffect(() => {\n    if (canvasRef.current !== null) {\n      setContext(\n        canvasRef.current.getContext('2d', options) as CanvasRenderingContext2D,\n      );\n    }\n  }, [options]);\n\n  return [context, canvasRef];\n}\n\nexport function useReducer<St, A>(\n  reducer: React.Reducer<St, A>,\n  initState: St,\n  ...middlewares: Middleware<St, A>[]\n): [St, React.Dispatch<A>] {\n  let [state, dispatch] = React.useReducer(reducer, initState);\n\n  // Snarfed from the Redux guide\n  middlewares = [...middlewares];\n  middlewares.reverse();\n  middlewares.forEach(middleware => {\n    dispatch = middleware(state, dispatch);\n  });\n\n  return [state, dispatch];\n}\n\nexport interface Middleware<St, A> {\n  (state: St, next: React.Dispatch<A>): React.Dispatch<A>;\n}\n","export function range(lo: number, hi: number): number[] {\n  const res = [];\n\n  for (let n = lo; n < hi; n++) {\n    res.push(n);\n  }\n\n  return res;\n}\n","import React from 'react';\nimport classNames from 'classnames';\nimport { range } from './tools';\nimport './SimpleEditor.css';\n\nexport interface SimpleEditorProps {\n  className?: string;\n  placeholder?: string;\n  value: string;\n  onChange: (value: string) => any;\n}\n\nconst SimpleEditor: React.FC<SimpleEditorProps> = props => {\n  const [lineCount, setLineCount] = React.useState(1);\n  const [isFocused, setIsFocused] = React.useState(false);\n\n  const { className, placeholder, value, onChange } = props;\n\n  const recomputeLineCount = React.useCallback(\n    (text: string) => {\n      const lines = text.split(/\\r\\n|\\n|\\r/).length;\n      setLineCount(lines);\n    },\n    [setLineCount],\n  );\n\n  React.useEffect(() => {\n    recomputeLineCount(value);\n  }, [recomputeLineCount, value]);\n\n  function handleChange(e: React.ChangeEvent<HTMLTextAreaElement>) {\n    const text = e.target.value;\n    recomputeLineCount(text);\n    onChange(text);\n  }\n\n  function handleFocus() {\n    setIsFocused(true);\n  }\n\n  function handleBlur() {\n    setIsFocused(false);\n  }\n\n  return (\n    <div\n      className={classNames('simple-editor', className, { focused: isFocused })}\n    >\n      <div className=\"simple-editor__scroller\">\n        <div className=\"simple-editor__line-numbers\">\n          {range(1, lineCount + 1).map(ln => (\n            <div key={ln}>{ln}</div>\n          ))}\n        </div>\n        <textarea\n          value={value}\n          onChange={handleChange}\n          placeholder={placeholder}\n          onFocus={handleFocus}\n          onBlur={handleBlur}\n          spellCheck=\"false\"\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default SimpleEditor;\n","import React from 'react';\nimport SimpleEditor from './SimpleEditor';\nimport Arrow from './Arrow';\nimport { useCanvasRenderingContext2D } from './hooks';\nimport { range } from './tools';\nimport { Vec2, Vec3, Mat2 } from './maths';\nimport './TrianglesDemo.css';\n\nconst WIDTH = 640;\nconst HEIGHT = 480;\nconst PX_SIZE = 10;\nconst PX_WIDTH = WIDTH / PX_SIZE;\nconst PX_HEIGHT = HEIGHT / PX_SIZE;\nconst PX_PER_MARKER = 10;\nconst SVG_OVERLAY_OFFSET = 10;\n\nconst TrianglesDemo: React.FC<{}> = () => {\n  const [verticesText, setVerticesText] = React.useState(`10, 10, 10, #770055\n40, 23, 0, #ff00ff\n5, 34, 5, #aa0099\n3, 22, 0, #ffff00\n55, 5, 15, #996600\n15, 45, 10, #aa8800`);\n  const [trisText, setTrisText] = React.useState(`1, 2, 3\n4, 5, 6`);\n  const [context, canvasRef] = useCanvasRenderingContext2D({ alpha: false });\n\n  const repaint = React.useCallback(\n    (verticesText: string, trisText: string) => {\n      const model = constructModel(verticesText, trisText);\n      if (model && context !== undefined) {\n        const img = context.getImageData(0, 0, WIDTH, HEIGHT);\n        renderModel(model, img);\n        context.putImageData(img, 0, 0);\n      }\n    },\n    [context],\n  );\n\n  React.useEffect(() => {\n    repaint(verticesText, trisText);\n  }, [verticesText, trisText, repaint]);\n\n  function handleVerticesTextChange(text: string) {\n    setVerticesText(text);\n    repaint(text, trisText);\n  }\n\n  function handleTrisTextChange(text: string) {\n    setTrisText(text);\n    repaint(verticesText, text);\n  }\n\n  return (\n    <div className=\"triangles-demo\">\n      <div className=\"canvas-container\">\n        <canvas ref={canvasRef} width={WIDTH} height={HEIGHT}></canvas>\n        <SvgOverlay />\n      </div>\n\n      <div className=\"editors\">\n        <SimpleEditor\n          className=\"vertex-editor\"\n          placeholder={'Enter vertices here, e.g.\\n1.0, 2.0, 1.5, #ff0000'}\n          value={verticesText}\n          onChange={handleVerticesTextChange}\n        />\n        <SimpleEditor\n          className=\"face-editor\"\n          placeholder={'Enter faces here, e.g.\\n1, 6, 5'}\n          value={trisText}\n          onChange={handleTrisTextChange}\n        />\n      </div>\n    </div>\n  );\n};\n\nfunction clearContext(img: ImageData, color: Color) {\n  for (let i = 0; i < img.data.length; i += 4) {\n    img.data[i] = color[0];\n    img.data[i + 1] = color[1];\n    img.data[i + 2] = color[2];\n    img.data[i + 3] = 255;\n  }\n}\n\nfunction renderModel(model: Model, img: ImageData) {\n  clearContext(img, [250, 250, 250]);\n  const zBuf = new Uint8ClampedArray(PX_WIDTH * PX_HEIGHT);\n  zBuf.fill(255);\n  model.vertices.forEach(v => drawPx(v, img, zBuf));\n  model.tris.forEach(tri => renderTri(tri, model.vertices, img, zBuf));\n}\n\nfunction renderTri(\n  tri: Tri,\n  vertices: Vertex[],\n  img: ImageData,\n  zBuf: Uint8ClampedArray,\n) {\n  if (tri.some(v => v < 1 || v > vertices.length)) {\n    // Some vertex out of bounds\n    return;\n  }\n  const [a, b, c] = tri.map(vI => vertices[vI - 1]);\n\n  const minX = Math.min(a.x, b.x, c.x, 0);\n  const minY = Math.min(a.y, b.y, c.y, 0);\n\n  const maxX = Math.max(a.x, b.x, c.x, PX_WIDTH);\n  const maxY = Math.max(a.y, b.y, c.y, PX_HEIGHT);\n\n  // New basis vectors\n  const u = new Vec2(b.x - a.x, b.y - a.y);\n  const v = new Vec2(c.x - a.x, c.y - a.y);\n\n  const trans = new Mat2(u.x, v.x, u.y, v.y).leftInv();\n\n  for (let x = minX; x < maxX; x++) {\n    for (let y = minY; y < maxY; y++) {\n      const relToA = new Vec2(x - a.x, y - a.y);\n      const baryCoords = trans.timesVec(relToA);\n      const fA = 1 - baryCoords.x - baryCoords.y;\n      const fB = baryCoords.x;\n      const fC = baryCoords.y;\n\n      if (fA < 0 || fB < 0 || fC < 0 || fA >= 1 || fB >= 1 || fC >= 1) {\n        continue;\n      }\n\n      const z = fA * a.z + fB * b.z + fC * c.z;\n      const color = Vec3.fromArray(a.color)\n        .scale(fA)\n        .plus(Vec3.fromArray(b.color).scale(fB))\n        .plus(Vec3.fromArray(c.color).scale(fC))\n        .toArray();\n      drawPx({ x, y, z, color }, img, zBuf);\n    }\n  }\n}\n\nfunction drawPx(px: Vertex, img: ImageData, zBuf: Uint8ClampedArray) {\n  const pxX = Math.floor(px.x);\n  const pxY = Math.floor(px.y);\n  const loc = pxY * PX_WIDTH + pxX;\n\n  // If this pixel is further than a previously-painted pixel, don't paint it\n  if (zBuf[loc] <= px.z) {\n    return;\n  }\n\n  zBuf[loc] = px.z;\n  for (let y = pxY * PX_SIZE; y < pxY * PX_SIZE + PX_SIZE; y++) {\n    for (let x = pxX * PX_SIZE; x < pxX * PX_SIZE + PX_SIZE; x++) {\n      const base = 4 * (y * WIDTH + x);\n      img.data[base] = px.color[0];\n      img.data[base + 1] = px.color[1];\n      img.data[base + 2] = px.color[2];\n      img.data[base + 3] = 255;\n    }\n  }\n}\n\nfunction constructModel(verticesText: string, trisText: string): Model {\n  const vertexLines = nonemptyLines(verticesText);\n  const vertices = vertexLines\n    .map(toVertex)\n    .filter(v => v !== undefined) as Vertex[];\n\n  const triLines = nonemptyLines(trisText);\n  const tris = triLines.map(toTri).filter(t => t !== undefined) as Tri[];\n\n  return { vertices, tris };\n}\n\nfunction toVertex(line: string): Vertex | undefined {\n  const parts = line.split(',').map(p => p.trim());\n  if (parts.length !== 4) {\n    return;\n  }\n\n  const [x, y, z, c] = parts;\n  const color = toColor(c);\n\n  if (color === undefined) {\n    return;\n  }\n\n  return {\n    x: Number(x),\n    y: Number(y),\n    z: Math.floor(Number(z)),\n    color,\n  };\n}\n\nfunction toColor(text: string): Color | undefined {\n  const hex = '\\\\d|[a-f]|[A-F]';\n  const pat = new RegExp(\n    `^#(?<r>(${hex})(${hex}))(?<g>(${hex})(${hex}))(?<b>(${hex})(${hex}))$`,\n  );\n\n  const match = pat.exec(text);\n  if (!match) {\n    return;\n  }\n\n  const { r, g, b } = match.groups as any;\n  return [parseInt(r, 16), parseInt(g, 16), parseInt(b, 16)];\n}\n\nfunction toTri(line: string): Tri | undefined {\n  const parts = line.split(',').map(p => p.trim());\n  if (parts.length !== 3) {\n    return;\n  }\n\n  const [v1, v2, v3] = parts;\n  return [Number(v1), Number(v2), Number(v3)];\n}\n\nfunction nonemptyLines(text: string) {\n  return text\n    .split(/\\r\\n|\\r|\\n/)\n    .map(l => l.trim())\n    .filter(l => l.length > 0);\n}\n\ninterface Model {\n  vertices: Vertex[];\n  tris: Tri[];\n}\n\ninterface Vertex {\n  x: number;\n  y: number;\n  z: number;\n  color: Color;\n}\n\n// R, G, B\ntype Color = [number, number, number];\n\n// V1, V2, V3\ntype Tri = [number, number, number];\n\nconst SvgOverlay: React.FC<{}> = () => {\n  return (\n    <svg\n      width={WIDTH + 2 * SVG_OVERLAY_OFFSET}\n      height={HEIGHT + 2 * SVG_OVERLAY_OFFSET}\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox={`0 0 ${WIDTH + 2 * SVG_OVERLAY_OFFSET} ${\n        HEIGHT + 2 * SVG_OVERLAY_OFFSET\n      }`}\n      style={{\n        position: 'absolute',\n        left: `-${SVG_OVERLAY_OFFSET}px`,\n        top: `-${SVG_OVERLAY_OFFSET}px`,\n      }}\n    >\n      <Arrow\n        x1={SVG_OVERLAY_OFFSET}\n        y1={SVG_OVERLAY_OFFSET}\n        x2={SVG_OVERLAY_OFFSET + PX_PER_MARKER * PX_SIZE}\n        y2={SVG_OVERLAY_OFFSET}\n        className=\"blue\"\n      />\n      <Arrow\n        x1={SVG_OVERLAY_OFFSET}\n        y1={SVG_OVERLAY_OFFSET}\n        x2={SVG_OVERLAY_OFFSET}\n        y2={SVG_OVERLAY_OFFSET + PX_PER_MARKER * PX_SIZE}\n        className=\"blue\"\n      />\n      {range(0, WIDTH / PX_SIZE / PX_PER_MARKER).map(xPx => (\n        <line\n          key={xPx}\n          x1={SVG_OVERLAY_OFFSET + xPx * PX_PER_MARKER * PX_SIZE}\n          y1={SVG_OVERLAY_OFFSET / 2}\n          x2={SVG_OVERLAY_OFFSET + xPx * PX_PER_MARKER * PX_SIZE}\n          y2={SVG_OVERLAY_OFFSET}\n          className=\"blue\"\n        />\n      ))}\n      {range(0, HEIGHT / PX_SIZE / PX_PER_MARKER).map(xPx => (\n        <line\n          key={xPx}\n          x1={SVG_OVERLAY_OFFSET / 2}\n          y1={SVG_OVERLAY_OFFSET + xPx * PX_PER_MARKER * PX_SIZE}\n          x2={SVG_OVERLAY_OFFSET}\n          y2={SVG_OVERLAY_OFFSET + xPx * PX_PER_MARKER * PX_SIZE}\n          className=\"blue\"\n        />\n      ))}\n    </svg>\n  );\n};\n\nexport default TrianglesDemo;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport './Home.css';\n\nconst Home: React.FC<{}> = () => {\n  return (\n    <div className=\"home\">\n      <div className=\"home__menu\">\n        <h1>3D Playground</h1>\n\n        <div className=\"home__menu-links\">\n          <Link to=\"barycentric\">Barycentric Coordinates</Link>\n          <Link to=\"triangles\">Painting Triangles</Link>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Home;\n","import React from 'react';\nimport { HashRouter as Router, Switch, Route } from 'react-router-dom';\nimport BarycentricDemo from './BarycentricDemo';\nimport TrianglesDemo from './TrianglesDemo';\nimport Home from './Home';\n\nconst App: React.FC<{}> = () => {\n  return (\n    <Router>\n      <Switch>\n        <Route path=\"/barycentric\">\n          <BarycentricDemo />\n        </Route>\n\n        <Route path=\"/triangles\">\n          <TrianglesDemo />\n        </Route>\n\n        <Route path=\"/\">\n          <Home />\n        </Route>\n      </Switch>\n    </Router>\n  );\n};\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './index.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}